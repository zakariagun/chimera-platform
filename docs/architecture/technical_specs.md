# ğŸ”§ Ø§Ù„Ù…ÙˆØ§ØµÙØ§Øª Ø§Ù„ØªÙ‚Ù†ÙŠØ© Ø§Ù„Ù…ÙØµÙ„Ø© - Ù…Ù†ØµØ© Chimera

## ğŸ“‹ Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø© ØªÙ‚Ù†ÙŠØ©

Ù‡Ø°Ø§ Ø§Ù„Ù…Ø³ØªÙ†Ø¯ ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªÙØ§ØµÙŠÙ„ Ø§Ù„ØªÙ‚Ù†ÙŠØ© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© Ù„Ø¨Ù†Ø§Ø¡ Ù…Ù†ØµØ© Chimera Ø¨Ø¯Ù‚Ø© ÙˆØ§Ø­ØªØ±Ø§ÙÙŠØ©.

---

## ğŸ—ï¸ Ø¨Ù†ÙŠØ© Ø§Ù„Ù…Ø´Ø±ÙˆØ¹

### Ù‡ÙŠÙƒÙ„ Ø§Ù„Ù…Ø¬Ù„Ø¯Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨:
```
chimera-platform/
â”œâ”€â”€ public/
â”‚   â”œâ”€â”€ index.html
â”‚   â”œâ”€â”€ manifest.json
â”‚   â””â”€â”€ icons/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ components/         # Ù…ÙƒÙˆÙ†Ø§Øª React Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…
â”‚   â”‚   â”œâ”€â”€ ui/            # Ù…ÙƒÙˆÙ†Ø§Øª UI Ø£Ø³Ø§Ø³ÙŠØ©
â”‚   â”‚   â”œâ”€â”€ forms/         # Ù†Ù…Ø§Ø°Ø¬ ÙˆÙ…Ø¯Ø®Ù„Ø§Øª
â”‚   â”‚   â””â”€â”€ layout/        # ØªØ®Ø·ÙŠØ· Ø§Ù„ØµÙØ­Ø§Øª
â”‚   â”œâ”€â”€ pages/             # ØµÙØ­Ø§Øª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
â”‚   â”‚   â”œâ”€â”€ Dashboard.tsx
â”‚   â”‚   â”œâ”€â”€ ProjectCreate.tsx
â”‚   â”‚   â”œâ”€â”€ ProjectWorkflow.tsx
â”‚   â”‚   â”œâ”€â”€ APIManagement.tsx
â”‚   â”‚   â””â”€â”€ Settings.tsx
â”‚   â”œâ”€â”€ hooks/             # React Hooks Ù…Ø®ØµØµØ©
â”‚   â”œâ”€â”€ services/          # Ø®Ø¯Ù…Ø§Øª APIs ÙˆØ§Ù„Ù…Ù†Ø·Ù‚
â”‚   â”‚   â”œâ”€â”€ ai/           # Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ
â”‚   â”‚   â”œâ”€â”€ supabase/     # ØªÙƒØ§Ù…Ù„ Supabase
â”‚   â”‚   â””â”€â”€ prompts/      # Ù…Ø­Ø±ÙƒØ§Øª Ø§Ù„ØªÙ„Ù‚ÙŠÙ†Ø§Øª
â”‚   â”œâ”€â”€ types/             # ØªØ¹Ø±ÙŠÙØ§Øª TypeScript
â”‚   â”œâ”€â”€ utils/             # ÙˆØ¸Ø§Ø¦Ù Ù…Ø³Ø§Ø¹Ø¯Ø©
â”‚   â”œâ”€â”€ stores/            # Zustand stores
â”‚   â”œâ”€â”€ styles/            # Ù…Ù„ÙØ§Øª CSS
â”‚   â””â”€â”€ App.tsx
â”œâ”€â”€ supabase/
â”‚   â”œâ”€â”€ migrations/        # Ù…Ù„ÙØ§Øª Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
â”‚   â”œâ”€â”€ functions/         # Edge Functions
â”‚   â””â”€â”€ seed.sql          # Ø¨ÙŠØ§Ù†Ø§Øª Ø£ÙˆÙ„ÙŠØ©
â”œâ”€â”€ docs/                  # Ø§Ù„ÙˆØ«Ø§Ø¦Ù‚
â”œâ”€â”€ package.json
â”œâ”€â”€ tsconfig.json
â”œâ”€â”€ tailwind.config.js
â””â”€â”€ vite.config.ts
```

---

## ğŸ—„ï¸ ØªØµÙ…ÙŠÙ… Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙØµÙ„

### 1. Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† (users)
```sql
CREATE TABLE users (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    email VARCHAR(255) UNIQUE NOT NULL,
    username VARCHAR(100) UNIQUE NOT NULL,
    full_name VARCHAR(255),
    avatar_url TEXT,
    subscription_plan subscription_plan_enum DEFAULT 'free',
    subscription_expires_at TIMESTAMP,
    total_projects INTEGER DEFAULT 0,
    total_prompts_generated INTEGER DEFAULT 0,
    preferences JSONB DEFAULT '{}',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    last_login_at TIMESTAMP
);

-- Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ÙÙ‡Ø§Ø±Ø³
CREATE INDEX idx_users_email ON users(email);
CREATE INDEX idx_users_subscription ON users(subscription_plan);
```

### 2. Ø¬Ø¯ÙˆÙ„ Ù…ÙØ§ØªÙŠØ­ APIs (api_keys)
```sql
CREATE TABLE api_keys (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID NOT NULL REFERENCES users(id) ON DELETE CASCADE,
    provider api_provider_enum NOT NULL,
    key_name VARCHAR(100) NOT NULL,
    encrypted_api_key TEXT NOT NULL,
    is_active BOOLEAN DEFAULT true,
    usage_count INTEGER DEFAULT 0,
    rate_limit_remaining INTEGER DEFAULT 1000,
    rate_limit_reset_at TIMESTAMP,
    last_used_at TIMESTAMP,
    error_count INTEGER DEFAULT 0,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    
    UNIQUE(user_id, provider, key_name)
);

-- Enums
CREATE TYPE api_provider_enum AS ENUM ('google_ai_studio', 'openrouter');
CREATE TYPE subscription_plan_enum AS ENUM ('free', 'pro', 'enterprise');
```

### 3. Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹ (projects)
```sql
CREATE TABLE projects (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID NOT NULL REFERENCES users(id) ON DELETE CASCADE,
    title VARCHAR(255) NOT NULL,
    description TEXT,
    initial_idea TEXT NOT NULL,
    project_type project_type_enum NOT NULL,
    target_platforms TEXT[] DEFAULT '{}',
    status project_status_enum DEFAULT 'idea',
    current_stage INTEGER DEFAULT 1,
    total_stages INTEGER DEFAULT 7,
    style_preferences JSONB DEFAULT '{}',
    quality_settings JSONB DEFAULT '{"min_score": 8.0}',
    metadata JSONB DEFAULT '{}',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    completed_at TIMESTAMP
);

CREATE TYPE project_type_enum AS ENUM ('video', 'audio', 'image', 'mixed', 'commercial', 'educational', 'entertainment');
CREATE TYPE project_status_enum AS ENUM ('idea', 'script', 'prompts', 'review', 'completed', 'exported', 'archived');

-- Ø§Ù„ÙÙ‡Ø§Ø±Ø³
CREATE INDEX idx_projects_user_id ON projects(user_id);
CREATE INDEX idx_projects_status ON projects(status);
CREATE INDEX idx_projects_created_at ON projects(created_at DESC);
```

### 4. Ø¬Ø¯ÙˆÙ„ Ù…Ø±Ø§Ø­Ù„ Ø§Ù„Ø¹Ù…Ù„ (workflow_stages)
```sql
CREATE TABLE workflow_stages (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    project_id UUID NOT NULL REFERENCES projects(id) ON DELETE CASCADE,
    stage_number INTEGER NOT NULL,
    stage_name VARCHAR(100) NOT NULL,
    stage_type stage_type_enum NOT NULL,
    input_data JSONB DEFAULT '{}',
    output_data JSONB DEFAULT '{}',
    ai_model_used VARCHAR(100),
    processing_time_ms INTEGER,
    tokens_consumed INTEGER DEFAULT 0,
    status stage_status_enum DEFAULT 'pending',
    quality_score DECIMAL(3,2),
    user_feedback TEXT,
    auto_approved BOOLEAN DEFAULT false,
    retry_count INTEGER DEFAULT 0,
    error_details JSONB,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    started_at TIMESTAMP,
    completed_at TIMESTAMP,
    approved_at TIMESTAMP,
    
    UNIQUE(project_id, stage_number)
);

CREATE TYPE stage_type_enum AS ENUM (
    'idea_expansion', 'media_analysis', 'research', 'script_generation',
    'video_prompts', 'image_prompts', 'audio_prompts', 'music_prompts',
    'quality_review', 'capcut_guide', 'export'
);

CREATE TYPE stage_status_enum AS ENUM (
    'pending', 'in_progress', 'completed', 'approved', 'rejected', 'error', 'skipped'
);
```

### 5. Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø´Ø®ØµÙŠØ§Øª (characters)
```sql
CREATE TABLE characters (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    project_id UUID NOT NULL REFERENCES projects(id) ON DELETE CASCADE,
    character_name VARCHAR(100) NOT NULL,
    character_role VARCHAR(100),
    physical_description TEXT NOT NULL,
    personality_traits TEXT,
    voice_characteristics JSONB DEFAULT '{}',
    visual_consistency_key TEXT NOT NULL, -- Ù„Ù„Ø­ÙØ§Ø¸ Ø¹Ù„Ù‰ Ø§Ù„ØªÙ†Ø§Ø³Ù‚ Ø§Ù„Ø¨ØµØ±ÙŠ
    voice_consistency_key TEXT, -- Ù„Ù„Ø­ÙØ§Ø¸ Ø¹Ù„Ù‰ ØªÙ†Ø§Ø³Ù‚ Ø§Ù„ØµÙˆØª
    appearance_count INTEGER DEFAULT 0,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    
    UNIQUE(project_id, character_name)
);

-- ÙÙ‡Ø±Ø³ Ù„Ù„Ø¨Ø­Ø« Ø§Ù„Ø³Ø±ÙŠØ¹
CREATE INDEX idx_characters_project_id ON characters(project_id);
```

### 6. Ø¬Ø¯ÙˆÙ„ Ø§Ù„ØªÙ„Ù‚ÙŠÙ†Ø§Øª Ø§Ù„Ù…ÙˆÙ„Ø¯Ø© (generated_prompts)
```sql
CREATE TABLE generated_prompts (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    project_id UUID NOT NULL REFERENCES projects(id) ON DELETE CASCADE,
    stage_id UUID NOT NULL REFERENCES workflow_stages(id) ON DELETE CASCADE,
    prompt_type prompt_type_enum NOT NULL,
    target_platform VARCHAR(50) NOT NULL,
    scene_number INTEGER,
    scene_title VARCHAR(255),
    prompt_text TEXT NOT NULL,
    prompt_parameters JSONB DEFAULT '{}',
    technical_settings JSONB DEFAULT '{}',
    character_id UUID REFERENCES characters(id),
    quality_score DECIMAL(3,2),
    estimated_duration INTEGER, -- Ø¨Ø§Ù„Ø«ÙˆØ§Ù†ÙŠ Ù„Ù„ÙÙŠØ¯ÙŠÙˆ/Ø§Ù„ØµÙˆØª
    estimated_tokens INTEGER,
    usage_count INTEGER DEFAULT 0,
    user_rating INTEGER CHECK (user_rating >= 1 AND user_rating <= 5),
    user_notes TEXT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TYPE prompt_type_enum AS ENUM (
    'video', 'image', 'audio_dialogue', 'audio_narration', 
    'music', 'sound_effects', 'character_description'
);

-- ÙÙ‡Ø§Ø±Ø³ Ù„Ù„Ø£Ø¯Ø§Ø¡
CREATE INDEX idx_prompts_project_id ON generated_prompts(project_id);
CREATE INDEX idx_prompts_type ON generated_prompts(prompt_type);
CREATE INDEX idx_prompts_platform ON generated_prompts(target_platform);
```

### 7. Ø¬Ø¯ÙˆÙ„ Ø§Ù„ÙˆØ³Ø§Ø¦Ø· Ø§Ù„Ù…Ø±ÙÙˆØ¹Ø© (uploaded_media)
```sql
CREATE TABLE uploaded_media (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    project_id UUID NOT NULL REFERENCES projects(id) ON DELETE CASCADE,
    file_name VARCHAR(255) NOT NULL,
    file_path VARCHAR(500) NOT NULL,
    file_type media_type_enum NOT NULL,
    file_size BIGINT NOT NULL,
    mime_type VARCHAR(100),
    duration_seconds INTEGER, -- Ù„Ù„ÙÙŠØ¯ÙŠÙˆ/Ø§Ù„ØµÙˆØª
    dimensions VARCHAR(20), -- Ù„Ù„ØµÙˆØ±/Ø§Ù„ÙÙŠØ¯ÙŠÙˆ (Ù…Ø«Ù„: "1920x1080")
    analysis_status analysis_status_enum DEFAULT 'pending',
    analysis_result JSONB DEFAULT '{}',
    analysis_error TEXT,
    is_reference BOOLEAN DEFAULT false,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    analyzed_at TIMESTAMP
);

CREATE TYPE media_type_enum AS ENUM ('image', 'video', 'audio');
CREATE TYPE analysis_status_enum AS ENUM ('pending', 'processing', 'completed', 'failed');

-- ÙÙ‡Ø±Ø³
CREATE INDEX idx_media_project_id ON uploaded_media(project_id);
```

### 8. Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù‚ÙˆØ§Ù„Ø¨ (templates)
```sql
CREATE TABLE templates (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    name VARCHAR(255) NOT NULL,
    description TEXT,
    category template_category_enum NOT NULL,
    template_data JSONB NOT NULL,
    preview_image_url TEXT,
    is_public BOOLEAN DEFAULT false,
    created_by UUID REFERENCES users(id),
    usage_count INTEGER DEFAULT 0,
    rating DECIMAL(2,1) DEFAULT 0.0,
    tags TEXT[] DEFAULT '{}',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TYPE template_category_enum AS ENUM (
    'marketing', 'educational', 'entertainment', 'documentary', 
    'social_media', 'corporate', 'personal'
);
```

---

## ğŸ”Œ ØªÙƒØ§Ù…Ù„ APIs

### 1. Google AI Studio Integration
```typescript
// src/services/ai/googleAIStudio.ts
interface GoogleAIStudioConfig {
  apiKey: string;
  model: string;
  temperature?: number;
  maxTokens?: number;
}

class GoogleAIStudioService {
  private baseURL = 'https://generativelanguage.googleapis.com/v1beta';
  
  async generateContent(prompt: string, config: GoogleAIStudioConfig): Promise<AIResponse> {
    const response = await fetch(`${this.baseURL}/models/${config.model}:generateContent`, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'x-goog-api-key': config.apiKey,
      },
      body: JSON.stringify({
        contents: [{
          parts: [{ text: prompt }]
        }],
        generationConfig: {
          temperature: config.temperature || 0.7,
          maxOutputTokens: config.maxTokens || 2048,
        }
      })
    });
    
    if (!response.ok) {
      throw new APIError(`Google AI Studio error: ${response.statusText}`);
    }
    
    return await response.json();
  }
  
  async generateSpeech(text: string, voiceConfig: VoiceConfig): Promise<AudioBuffer> {
    // ØªÙ†ÙÙŠØ° ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù†Øµ Ø¥Ù„Ù‰ ØµÙˆØª
  }
}
```

### 2. OpenRouter Integration
```typescript
// src/services/ai/openRouter.ts
interface OpenRouterConfig {
  apiKey: string;
  model: string;
  temperature?: number;
  maxTokens?: number;
}

class OpenRouterService {
  private baseURL = 'https://openrouter.ai/api/v1';
  
  async generateContent(prompt: string, config: OpenRouterConfig): Promise<AIResponse> {
    const response = await fetch(`${this.baseURL}/chat/completions`, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'Authorization': `Bearer ${config.apiKey}`,
        'HTTP-Referer': window.location.origin,
        'X-Title': 'Chimera Platform',
      },
      body: JSON.stringify({
        model: config.model,
        messages: [{
          role: 'user',
          content: prompt
        }],
        temperature: config.temperature || 0.7,
        max_tokens: config.maxTokens || 2048,
      })
    });
    
    if (!response.ok) {
      throw new APIError(`OpenRouter error: ${response.statusText}`);
    }
    
    return await response.json();
  }
}
```

### 3. Unified AI Service
```typescript
// src/services/ai/unifiedAI.ts
interface AIServiceConfig {
  provider: 'google_ai_studio' | 'openrouter';
  apiKey: string;
  model: string;
  temperature?: number;
  maxTokens?: number;
}

class UnifiedAIService {
  private googleService = new GoogleAIStudioService();
  private openRouterService = new OpenRouterService();
  
  async generateContent(prompt: string, config: AIServiceConfig): Promise<AIResponse> {
    try {
      switch (config.provider) {
        case 'google_ai_studio':
          return await this.googleService.generateContent(prompt, config);
        case 'openrouter':
          return await this.openRouterService.generateContent(prompt, config);
        default:
          throw new Error(`Unsupported provider: ${config.provider}`);
      }
    } catch (error) {
      // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø·Ø£ ÙˆØ¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù€ fallback
      throw new AIServiceError(error.message, config.provider);
    }
  }
}
```

---

## ğŸ§  Ù…Ø­Ø±ÙƒØ§Øª Ø§Ù„ØªÙ„Ù‚ÙŠÙ†Ø§Øª

### 1. Ù…Ø­Ø±Ùƒ ØªÙ„Ù‚ÙŠÙ†Ø§Øª Ø§Ù„ÙÙŠØ¯ÙŠÙˆ (Veo3)
```typescript
// src/services/prompts/videoPromptEngine.ts
interface VideoScene {
  id: string;
  title: string;
  description: string;
  characters: Character[];
  environment: string;
  action: string;
  emotion: string;
  duration: number;
}

interface VideoPromptSettings {
  style: 'cinematic' | 'documentary' | 'commercial' | 'social_media';
  quality: 'standard' | 'high' | 'ultra';
  aspectRatio: '16:9' | '9:16' | '1:1' | '4:3';
  duration: number;
}

class VideoPromptEngine {
  private styleTemplates = {
    cinematic: {
      lighting: 'cinematic lighting, dramatic shadows',
      camera: 'professional cinematography, smooth camera movements',
      quality: 'high production value, film-grade quality'
    },
    documentary: {
      lighting: 'natural lighting, authentic feel',
      camera: 'handheld camera, realistic movement',
      quality: 'documentary style, observational'
    },
    commercial: {
      lighting: 'bright, even lighting',
      camera: 'stable shots, dynamic angles',
      quality: 'commercial production, polished'
    },
    social_media: {
      lighting: 'trendy lighting, high contrast',
      camera: 'dynamic shots, quick cuts',
      quality: 'social media optimized, engaging'
    }
  };
  
  generateVideoPrompt(scene: VideoScene, settings: VideoPromptSettings): string {
    const style = this.styleTemplates[settings.style];
    const characterDesc = this.buildCharacterDescription(scene.characters);
    const environmentDesc = this.enhanceEnvironmentDescription(scene.environment);
    const actionDesc = this.buildActionDescription(scene.action, scene.emotion);
    const technicalParams = this.buildTechnicalParameters(settings);
    
    return `${characterDesc} ${actionDesc} in ${environmentDesc}. 
            Camera: ${style.camera}, ${this.getCameraWork(scene.action)}.
            Lighting: ${style.lighting}.
            Style: ${style.quality}, ${technicalParams}.
            Duration: ${settings.duration} seconds.`;
  }
  
  private buildCharacterDescription(characters: Character[]): string {
    return characters.map(char => 
      `${char.name}: ${char.physicalDescription}, ${char.currentEmotion}`
    ).join(', ');
  }
  
  private getCameraWork(action: string): string {
    const cameraMap = {
      'walking': 'tracking shot, smooth dolly movement',
      'talking': 'medium shot, slight zoom in',
      'running': 'dynamic follow shot, handheld camera',
      'sitting': 'static shot, slow zoom',
      'dancing': 'sweeping camera movements, multiple angles'
    };
    
    return cameraMap[action.toLowerCase()] || 'standard cinematography';
  }
}
```

### 2. Ù…Ø­Ø±Ùƒ ØªÙ„Ù‚ÙŠÙ†Ø§Øª Ø§Ù„ØµÙˆØ± (Imagen4/Flux)
```typescript
// src/services/prompts/imagePromptEngine.ts
interface ImagePromptSettings {
  platform: 'imagen4' | 'flux_context' | 'dalle3';
  style: string;
  quality: 'standard' | 'hd' | 'ultra';
  aspectRatio: string;
  lighting: string;
}

class ImagePromptEngine {
  private platformSettings = {
    imagen4: {
      prefix: '',
      suffix: '--style photorealistic --quality hd',
      maxLength: 1000
    },
    flux_context: {
      prefix: 'FLUX.1 Pro: ',
      suffix: ', ultra-detailed, professional photography',
      maxLength: 800
    },
    dalle3: {
      prefix: '',
      suffix: ', photorealistic, high detail',
      maxLength: 400
    }
  };
  
  generateImagePrompt(
    description: string, 
    character: Character | null,
    settings: ImagePromptSettings
  ): string {
    const platform = this.platformSettings[settings.platform];
    let prompt = platform.prefix;
    
    // Ø¥Ø¶Ø§ÙØ© ÙˆØµÙ Ø§Ù„Ø´Ø®ØµÙŠØ© (Ù…Ø¹ Ø¶Ù…Ø§Ù† Ø§Ù„ØªÙ†Ø§Ø³Ù‚)
    if (character) {
      prompt += `${character.visualConsistencyKey}, `;
    }
    
    // Ø¥Ø¶Ø§ÙØ© Ø§Ù„ÙˆØµÙ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ
    prompt += `${description}. `;
    
    // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¥Ø¶Ø§Ø¡Ø© ÙˆØ§Ù„Ø£Ø³Ù„ÙˆØ¨
    prompt += `Lighting: ${settings.lighting}. Style: ${settings.style}. `;
    
    // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„ØªÙ‚Ù†ÙŠØ©
    prompt += platform.suffix;
    
    // Ù‚Ø·Ø¹ Ø§Ù„Ù†Øµ Ø¥Ø°Ø§ ÙƒØ§Ù† Ø·ÙˆÙŠÙ„Ø§Ù‹ Ø¬Ø¯Ø§Ù‹
    if (prompt.length > platform.maxLength) {
      prompt = prompt.substring(0, platform.maxLength - 3) + '...';
    }
    
    return prompt;
  }
  
  generateCharacterConsistencyKey(character: Character): string {
    // Ø¥Ù†Ø´Ø§Ø¡ Ù…ÙØªØ§Ø­ Ø«Ø§Ø¨Øª Ù„Ù„Ø´Ø®ØµÙŠØ© Ù„Ø¶Ù…Ø§Ù† Ø§Ù„ØªÙ†Ø§Ø³Ù‚
    return `${character.name}: ${character.age}-year-old ${character.gender}, 
            ${character.hairColor} hair, ${character.eyeColor} eyes, 
            ${character.height}, ${character.build}, 
            wearing ${character.defaultOutfit}`;
  }
}
```

### 3. Ù…Ø­Ø±Ùƒ ØªÙ„Ù‚ÙŠÙ†Ø§Øª Ø§Ù„ØµÙˆØª (ElevenLabs)
```typescript
// src/services/prompts/audioPromptEngine.ts
interface AudioSettings {
  voice: string;
  emotion: string;
  speed: number;
  stability: number;
  clarity: number;
}

interface DialogueItem {
  character: string;
  text: string;
  emotion: string;
  pause?: number;
  emphasis?: string[];
}

class AudioPromptEngine {
  private emotionTags = {
    happy: '[cheerful, upbeat]',
    sad: '[melancholy, slow]',
    angry: '[intense, sharp]',
    excited: '[energetic, fast]',
    calm: '[peaceful, steady]',
    mysterious: '[whispered, suspenseful]',
    dramatic: '[theatrical, emphasized]'
  };
  
  generateVoicePrompt(dialogue: DialogueItem, settings: AudioSettings): VoicePrompt {
    let processedText = dialogue.text;
    
    // Ø¥Ø¶Ø§ÙØ© Ø¹Ù„Ø§Ù…Ø§Øª Ø§Ù„ØªÙˆÙ‚Ù
    if (dialogue.pause) {
      processedText += `<break time="${dialogue.pause}s" />`;
    }
    
    // Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØªØ£ÙƒÙŠØ¯ Ø¹Ù„Ù‰ ÙƒÙ„Ù…Ø§Øª Ù…Ø¹ÙŠÙ†Ø©
    if (dialogue.emphasis) {
      dialogue.emphasis.forEach(word => {
        processedText = processedText.replace(
          new RegExp(`\\b${word}\\b`, 'gi'),
          `<emphasis level="strong">${word}</emphasis>`
        );
      });
    }
    
    // Ø¥Ø¶Ø§ÙØ© Ø¹Ù„Ø§Ù…Ø§Øª Ø§Ù„Ø¹Ø§Ø·ÙØ©
    const emotionTag = this.emotionTags[dialogue.emotion] || '';
    processedText = `${emotionTag} ${processedText}`;
    
    return {
      text: processedText,
      voice: settings.voice,
      model_id: "eleven_monolingual_v1",
      voice_settings: {
        stability: settings.stability,
        similarity_boost: settings.clarity,
        style: settings.speed
      }
    };
  }
  
  generateMusicPrompt(scene: VideoScene, mood: string): string {
    const musicStyles = {
      epic: 'orchestral, cinematic, powerful drums, rising strings',
      romantic: 'soft piano, gentle strings, warm and intimate',
      suspense: 'dark ambient, tension building, minimalist',
      action: 'fast-paced, electronic beats, intense energy',
      peaceful: 'acoustic guitar, nature sounds, calm and relaxing'
    };
    
    const basePrompt = musicStyles[mood] || 'ambient background music';
    const duration = scene.duration || 30;
    
    return `Generate ${duration}-second background music: ${basePrompt}. 
            Tempo: medium, Key: C major, Mood: ${mood}. 
            No vocals, instrumental only.`;
  }
}
```

---

## ğŸ”„ Ù†Ø¸Ø§Ù… Workflow

### Ù…Ø¯ÙŠØ± Ù…Ø±Ø§Ø­Ù„ Ø§Ù„Ø¹Ù…Ù„
```typescript
// src/services/workflow/workflowManager.ts
interface WorkflowStage {
  id: string;
  number: number;
  name: string;
  type: StageType;
  status: StageStatus;
  dependencies: string[];
  estimatedDuration: number;
  maxRetries: number;
}

class WorkflowManager {
  private stages: WorkflowStage[] = [
    {
      id: 'idea_expansion',
      number: 1,
      name: 'ØªÙˆØ³ÙŠØ¹ Ø§Ù„ÙÙƒØ±Ø©',
      type: 'idea_expansion',
      status: 'pending',
      dependencies: [],
      estimatedDuration: 120,
      maxRetries: 3
    },
    {
      id: 'media_analysis',
      number: 2,
      name: 'ØªØ­Ù„ÙŠÙ„ Ø§Ù„ÙˆØ³Ø§Ø¦Ø·',
      type: 'media_analysis',
      status: 'pending',
      dependencies: ['idea_expansion'],
      estimatedDuration: 180,
      maxRetries: 2
    },
    // Ø§Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„Ù…Ø±Ø§Ø­Ù„...
  ];
  
  async executeStage(projectId: string, stageId: string): Promise<StageResult> {
    const stage = this.stages.find(s => s.id === stageId);
    if (!stage) {
      throw new Error(`Stage ${stageId} not found`);
    }
    
    // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§ÙƒØªÙ…Ø§Ù„ Ø§Ù„Ù…Ø±Ø§Ø­Ù„ Ø§Ù„ØªØ§Ø¨Ø¹Ø©
    for (const depId of stage.dependencies) {
      const isCompleted = await this.isStageCompleted(projectId, depId);
      if (!isCompleted) {
        throw new Error(`Dependency ${depId} not completed`);
      }
    }
    
    // ØªÙ†ÙÙŠØ° Ø§Ù„Ù…Ø±Ø­Ù„Ø©
    const result = await this.processStage(projectId, stage);
    
    // Ø­ÙØ¸ Ø§Ù„Ù†ØªÙŠØ¬Ø©
    await this.saveStageResult(projectId, stageId, result);
    
    return result;
  }
  
  private async processStage(projectId: string, stage: WorkflowStage): Promise<StageResult> {
    switch (stage.type) {
      case 'idea_expansion':
        return await this.expandIdea(projectId);
      case 'media_analysis':
        return await this.analyzeMedia(projectId);
      case 'script_generation':
        return await this.generateScript(projectId);
      // Ø§Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ù…Ø±Ø§Ø­Ù„...
      default:
        throw new Error(`Unknown stage type: ${stage.type}`);
    }
  }
}
```

ÙŠÙØªÙØ¨ÙØ¹...